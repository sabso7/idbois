(function(e,a){typeof exports=="object"&&typeof module!="undefined"?module.exports=a(require("vue")):typeof define=="function"&&define.amd?define(["vue"],a):(e=typeof globalThis!="undefined"?globalThis:e||self,e.MasonryWall=a(e.Vue))})(this,function(e){"use strict";const a=["data-index"],x=e.defineComponent({props:{columnWidth:{default:400},items:null,gap:{default:0},rtl:{type:Boolean,default:!1},ssrColumns:{default:0}},emits:["redraw","redraw-skip"],setup(r,{emit:d}){const C=r,{columnWidth:h,items:s,gap:c,rtl:w,ssrColumns:p}=e.toRefs(C),i=e.ref([]),u=e.ref();function y(){const n=Math.floor((u.value.getBoundingClientRect().width+c.value)/(h.value+c.value));return n>0?n:1}function g(n){return[...new Array(n)].map(()=>[])}if(p.value>0){const n=g(p.value);s.value.forEach((l,o)=>n[o%p.value].push(o)),i.value=n}async function k(n){if(n>=s.value.length)return;await e.nextTick();const l=[...u.value.children];w.value&&l.reverse();const o=l.reduce((f,t)=>t.getBoundingClientRect().height<f.getBoundingClientRect().height?t:f);i.value[+o.dataset.index].push(n),await k(n+1)}async function m(n=!1){if(i.value.length===y()&&!n){d("redraw-skip");return}i.value=g(y());const l=window.scrollY;await k(0),window.scrollTo({top:l}),d("redraw")}const B=new ResizeObserver(()=>m());return e.onMounted(()=>{m(),B.observe(u.value)}),e.onBeforeUnmount(()=>B.unobserve(u.value)),e.watch([s,w],()=>m(!0)),e.watch([h,c],()=>m()),(n,l)=>(e.openBlock(),e.createElementBlock("div",{ref_key:"wall",ref:u,class:"masonry-wall",style:e.normalizeStyle({display:"flex",gap:`${e.unref(c)}px`})},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(i.value,(o,f)=>(e.openBlock(),e.createElementBlock("div",{key:f,class:"masonry-column","data-index":f,style:e.normalizeStyle({display:"flex","flex-basis":0,"flex-direction":"column","flex-grow":1,height:["-webkit-max-content","-moz-max-content","max-content"],gap:`${e.unref(c)}px`})},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(o,t=>(e.openBlock(),e.createElementBlock("div",{key:t,class:"masonry-item"},[e.renderSlot(n.$slots,"default",{item:e.unref(s)[t],index:t},()=>[e.createTextVNode(e.toDisplayString(e.unref(s)[t]),1)])]))),128))],12,a))),128))],4))}});return(()=>{const r=x;return r.install=d=>{d.component("MasonryWall",r)},r})()});
